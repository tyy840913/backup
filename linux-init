#!/bin/bash

# =========================================================
# ğŸš€ Linux å…¨è‡ªåŠ¨åˆå§‹åŒ–è„šæœ¬ (å¢å¼ºç‰ˆ)
#
# è¯´æ˜ï¼š
# - è‡ªåŠ¨æ£€æµ‹å¹¶å®‰è£…ç¼ºå¤±çš„å…³é”®å‘½ä»¤ã€‚
# - æ™ºèƒ½é€‚é… Netplan å’Œ interfaces è¿›è¡Œé™æ€IPè®¾ç½®ã€‚
# - æ¯ä¸ªåŠŸèƒ½æ¨¡å—å‡åŒ…å«å¤‡ç”¨æ–¹æ¡ˆå’Œé”™è¯¯æ£€æµ‹ã€‚
# - è¾“å‡ºä»…é™å…³é”®æç¤ºï¼Œä¿è¯ç®€æ´ã€‚
# - å…¼å®¹ Debian/Ubuntu å¸¸è§ç¯å¢ƒã€‚
# =========================================================

# --- å…¨å±€è®¾ç½® ---
# set -e: ä¸€æ—¦æœ‰å‘½ä»¤è¿”å›éé›¶å€¼ï¼ˆé”™è¯¯ï¼‰ï¼Œç«‹å³é€€å‡ºè„šæœ¬
# set -o pipefail: ç®¡é“ä¸­çš„ä»»ä½•ä¸€ä¸ªå‘½ä»¤å¤±è´¥ï¼Œæ•´ä¸ªç®¡é“éƒ½è§†ä¸ºå¤±è´¥
set -e
set -o pipefail

# --- æƒé™æ£€æŸ¥ ---
if [[ $EUID -ne 0 ]]; then
   echo "âŒ è¯·ä½¿ç”¨rootæƒé™æ‰§è¡Œè„šæœ¬"
   exit 1
fi

export LANG=C.UTF-8

# --- æ ¸å¿ƒè¾…åŠ©å‡½æ•°ï¼šç¡®ä¿å‘½ä»¤å­˜åœ¨ï¼Œä¸å­˜åœ¨åˆ™å°è¯•å®‰è£… ---
ensure_command() {
    local cmd="$1"
    local pkg="$2"
    if ! command -v "$cmd" &>/dev/null; then
        echo "âš ï¸ å‘½ä»¤ '$cmd' ä¸å­˜åœ¨, å°è¯•å®‰è£…è½¯ä»¶åŒ… '$pkg'..."
        apt-get update -qq
        apt-get install -y -qq "$pkg"
        if ! command -v "$cmd" &>/dev/null; then
            echo "âŒ å®‰è£… '$pkg' å¤±è´¥, æ— æ³•æ‰§è¡Œç›¸å…³åŠŸèƒ½ã€‚"
            # è¿”å›1è¡¨ç¤ºå¤±è´¥ï¼Œè°ƒç”¨è€…å¯ä»¥æ ¹æ®æ­¤å†³å®šæ˜¯å¦ç»§ç»­
            return 1
        fi
        echo "âœ… å‘½ä»¤ '$cmd' å®‰è£…æˆåŠŸã€‚"
    fi
    # è¿”å›0è¡¨ç¤ºæˆåŠŸ
    return 0
}


# =========================================================
#                   åŠŸèƒ½æ¨¡å—å®šä¹‰
# =========================================================

# ================== 1. æ›´æ¢APTæºä¸ºæ¸…åé•œåƒ ===================
auto_set_apt_sources() {
    echo "1/7 æ›´æ¢APTæºä¸ºæ¸…åé•œåƒ..."

    # ç¡®ä¿ lsb_release å‘½ä»¤å­˜åœ¨
    if ! ensure_command "lsb_release" "lsb-release"; then
        echo "âš ï¸ è·³è¿‡APTæºæ›¿æ¢ã€‚"
        return
    fi

    local BACKUP="/etc/apt/sources.list.bak_$(date +%Y%m%d%H%M%S)"
    echo "  - å¤‡ä»½å½“å‰æºåˆ° $BACKUP"
    if [ -f /etc/apt/sources.list ]; then
        cp /etc/apt/sources.list "$BACKUP"
    fi

    local CODENAME
    CODENAME=$(lsb_release -cs 2>/dev/null)
    if [[ -z "$CODENAME" ]]; then
        echo "âš ï¸ æ— æ³•è·å–ç³»ç»Ÿä»£å·, è·³è¿‡APTæºæ›¿æ¢"
        cp "$BACKUP" /etc/apt/sources.list # æ¢å¤å¤‡ä»½
        return
    fi

    echo "  - ç³»ç»Ÿä»£å·: $CODENAME"

    if grep -qi 'ubuntu' /etc/os-release; then
        cat >/etc/apt/sources.list <<EOF
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ $CODENAME main restricted universe multiverse
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ $CODENAME-updates main restricted universe multiverse
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ $CODENAME-backports main restricted universe multiverse
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ $CODENAME-security main restricted universe multiverse
EOF
    elif grep -qi 'debian' /etc/os-release; then
        cat >/etc/apt/sources.list <<EOF
deb https://mirrors.tuna.tsinghua.edu.cn/debian/ $CODENAME main contrib non-free
deb https://mirrors.tuna.tsinghua.edu.cn/debian/ $CODENAME-updates main contrib non-free
deb https://mirrors.tuna.tsinghua.edu.cn/debian/ $CODENAME-backports main contrib non-free
deb https://mirrors.tuna.tsinghua.edu.cn/debian-security/ $CODENAME-security main contrib non-free
EOF
    else
        echo "âš ï¸ ä¸æ”¯æŒçš„ç³»ç»Ÿ, è·³è¿‡APTæºæ›¿æ¢"
        [ -f "$BACKUP" ] && cp "$BACKUP" /etc/apt/sources.list
        return
    fi

    echo "  - æ­£åœ¨æ›´æ–°APTç¼“å­˜..."
    if apt-get update -qq; then
        echo "âœ… APTæºæ›¿æ¢æˆåŠŸ"
    else
        echo "âš ï¸ APTæ›´æ–°å¤±è´¥, æ­£åœ¨æ¢å¤æºæ–‡ä»¶..."
        [ -f "$BACKUP" ] && cp "$BACKUP" /etc/apt/sources.list
        echo "  - å·²æ¢å¤å¤‡ä»½æº, è¯·æ‰‹åŠ¨æ£€æŸ¥é—®é¢˜ã€‚"
    fi
    echo "-------------------------------------"
}

# ================== 2. å®‰è£…ä¾èµ–å·¥å…· ===================
auto_install_dependencies() {
    echo "2/7 å®‰è£…å¿…è¦å·¥å…·..."

    # æ ¸å¿ƒå·¥å…·åˆ—è¡¨ (å­—ä½“åŒ…ç§»è‡³å­—ä½“æ¨¡å—)
    local PKGS="curl wget vim htop net-tools nano ufw unzip bc tar"

    if ! command -v apt-get &>/dev/null; then
        echo "âš ï¸ æœªæ£€æµ‹åˆ°apt-get, è·³è¿‡ä¾èµ–å®‰è£…"
        return
    fi

    echo "  - å‡†å¤‡å®‰è£…: $PKGS"
    if apt-get install -y $PKGS -qq; then
        echo "âœ… å·¥å…·å®‰è£…æˆåŠŸ"
    else
        echo "âš ï¸ éƒ¨åˆ†å·¥å…·å®‰è£…å¤±è´¥, è¯·æ‰‹åŠ¨æ£€æŸ¥ã€‚"
    fi
    echo "-------------------------------------"
}

# ================== 3. è®¾ç½®æ—¶åŒº ===================
auto_set_timezone() {
    echo "3/7 è®¾ç½®æ—¶åŒºä¸º Asia/Shanghai..."

    # ä¼˜å…ˆç”¨timedatectl
    if command -v timedatectl &>/dev/null; then
        timedatectl set-timezone Asia/Shanghai
        echo "âœ… æ—¶åŒºè®¾ç½®æˆåŠŸ (ä½¿ç”¨ timedatectl)"
        echo "-------------------------------------"
        return
    fi

    # å¤‡ç”¨æ–¹æ¡ˆï¼šæ›¿æ¢ /etc/localtime
    if [ -f /usr/share/zoneinfo/Asia/Shanghai ]; then
        ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime
        echo "âœ… æ—¶åŒºè®¾ç½®æˆåŠŸ (ä½¿ç”¨ /etc/localtime)"
        echo "-------------------------------------"
        return
    fi

    echo "âš ï¸ æ—¶åŒºè®¾ç½®å¤±è´¥, timedatectl å’Œ zoneinfo æ–‡ä»¶å‡ä¸å¯ç”¨ã€‚"
    echo "-------------------------------------"
}

# ================== 4. é…ç½®SSHå…è®¸rootå¯†ç ç™»å½• ===================
auto_config_ssh() {
    echo "4/7 é…ç½®SSHå…è®¸rootå¯†ç ç™»å½•..."
    local SSH_CONF="/etc/ssh/sshd_config"

    if [ ! -f "$SSH_CONF" ]; then
        echo "âš ï¸ æœªæ‰¾åˆ°SSHé…ç½®æ–‡ä»¶, è·³è¿‡"
        return
    fi

    # å¤‡ä»½é…ç½®
    cp "$SSH_CONF" "$SSH_CONF.bak_$(date +%Y%m%d%H%M%S)"

    # ä¿®æ”¹é…ç½®
    sed -i 's/^#\?PermitRootLogin.*/PermitRootLogin yes/' "$SSH_CONF"
    sed -i 's/^#\?PasswordAuthentication.*/PasswordAuthentication yes/' "$SSH_CONF"

    # é‡å¯sshæœåŠ¡ï¼ˆå°è¯•ä¸¤ç§æœåŠ¡åï¼‰
    echo "  - æ­£åœ¨é‡å¯SSHæœåŠ¡..."
    if systemctl restart sshd 2>/dev/null; then
        echo "âœ… SSHé…ç½®ç”Ÿæ•ˆ (sshd æœåŠ¡)"
    elif systemctl restart ssh 2>/dev/null; then
        echo "âœ… SSHé…ç½®ç”Ÿæ•ˆ (ssh æœåŠ¡)"
    else
        echo "âš ï¸ SSHæœåŠ¡é‡å¯å¤±è´¥, è¯·æ‰‹åŠ¨æ‰§è¡Œ 'systemctl restart ssh' æˆ– 'systemctl restart sshd'"
    fi
    echo "-------------------------------------"
}

# ================== 5. ç¦ç”¨é˜²ç«å¢™ï¼Œæ”¾é€šæ‰€æœ‰ç«¯å£ ===================
auto_disable_firewall() {
    echo "5/7 ç¦ç”¨ç³»ç»Ÿé˜²ç«å¢™..."

    # ufwç¦ç”¨
    if command -v ufw &>/dev/null; then
        ufw --force disable >/dev/null 2>&1
        echo "âœ… UFWå·²ç¦ç”¨"
    fi

    # firewalldç¦ç”¨ (é€šå¸¸åœ¨CentOS/RHEL, ä½†ä¹Ÿæ£€æŸ¥ä¸€ä¸‹)
    if systemctl list-unit-files | grep -q firewalld.service; then
        systemctl stop firewalld.service
        systemctl disable firewalld.service
        echo "âœ… firewalldå·²ç¦ç”¨"
    fi

    # æ¸…ç©ºiptablesè§„åˆ™
    if command -v iptables &>/dev/null; then
        iptables -F
        iptables -X
        iptables -P INPUT ACCEPT
        iptables -P FORWARD ACCEPT
        iptables -P OUTPUT ACCEPT
        echo "âœ… iptablesè§„åˆ™å·²æ¸…ç©º"
    fi

    echo "-------------------------------------"
}

# ================== 6. å­—ä½“å®‰è£…å’Œé…ç½® ===================
auto_set_fonts() {
    echo "6/7 å®‰è£…ä¸­æ–‡å­—ä½“å¹¶é…ç½®ç¯å¢ƒ..."

    # å®‰è£…å¸¸è§çš„ä¸­æ–‡å­—ä½“
    local FONT_PKGS="fonts-wqy-zenhei fonts-wqy-microhei"
    echo "  - å‡†å¤‡å®‰è£…å­—ä½“åŒ…: $FONT_PKGS"
    if apt-get install -y $FONT_PKGS -qq; then
        echo "âœ… å­—ä½“åŒ…å®‰è£…æˆåŠŸ"
    else
        echo "âš ï¸ å­—ä½“å®‰è£…å¤±è´¥, å¯èƒ½å½±å“ä¸­æ–‡æ˜¾ç¤ºã€‚"
    fi

    # è®¾ç½®ç³»ç»Ÿçº§ä¸­æ–‡ç¯å¢ƒ
    if ! grep -q "LANG=zh_CN.UTF-8" /etc/default/locale 2>/dev/null; then
        echo "  - è®¾ç½®ç³»ç»Ÿé»˜è®¤localeä¸º zh_CN.UTF-8"
        echo "LANG=zh_CN.UTF-8" > /etc/default/locale
        export LANG=zh_CN.UTF-8
        echo "âœ… ä¸­æ–‡ç¯å¢ƒè®¾ç½®æˆåŠŸ (éœ€è¦é‡æ–°ç™»å½•ä»¥å®Œå…¨ç”Ÿæ•ˆ)"
    else
        echo "  - ä¸­æ–‡ç¯å¢ƒå·²æ˜¯ zh_CN.UTF-8, æ— éœ€æ›´æ”¹ã€‚"
    fi
    echo "-------------------------------------"
}


# ================== 7. äº¤äº’å¼é™æ€IPè®¾ç½® ===================
interactive_set_static_ip() {
    echo "7/7 äº¤äº’å¼é™æ€IPè®¾ç½®"

    # --- IPåˆæ³•æ€§æ ¡éªŒå‡½æ•° ---
    is_valid_ip() {
        local ip=$1
        if [[ $ip =~ ^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$ ]]; then
            OIFS=$IFS
            IFS='.'
            ip=($ip)
            IFS=$OIFS
            [[ ${ip[0]} -le 255 && ${ip[1]} -le 255 && ${ip[2]} -le 255 && ${ip[3]} -le 255 ]]
            return $?
        fi
        return 1
    }

    # --- è‡ªåŠ¨æ£€æµ‹ç½‘ç»œä¿¡æ¯ ---
    local IFACE
    IFACE=$(ip -o -4 route show to default | awk '{print $5}')
    if [[ -z "$IFACE" ]]; then
        echo "âš ï¸ æ— æ³•è‡ªåŠ¨æ£€æµ‹é»˜è®¤ç½‘ç»œæ¥å£, è·³è¿‡é™æ€IPè®¾ç½®ã€‚"
        return
    fi
    echo "  - æ£€æµ‹åˆ°é»˜è®¤ç½‘ç»œæ¥å£: $IFACE"

    local IP_CIDR
    IP_CIDR=$(ip -4 addr show "$IFACE" | grep -oP '(?<=inet\s)\d+(\.\d+){3}/\d+' | head -1)
    if [[ -z "$IP_CIDR" ]]; then
        echo "âš ï¸ æ— æ³•åœ¨æ¥å£ $IFACE ä¸Šæ£€æµ‹åˆ°å½“å‰IP, è·³è¿‡é™æ€IPè®¾ç½®ã€‚"
        return
    fi

    local CURRENT_IP=${IP_CIDR%/*}
    local CIDR=${IP_CIDR#*/}
    local GATEWAY
    GATEWAY=$(ip route | awk '/default/ {print $3}')
    local DNS_SERVERS
    DNS_SERVERS=$(grep "nameserver" /etc/resolv.conf | awk '{print $2}' | tr '\n' ' ')

    echo ""
    echo "--- è¯·è¾“å…¥æ–°çš„ç½‘ç»œé…ç½® (ç›´æ¥å›è½¦ä½¿ç”¨æ‹¬å·å†…çš„å½“å‰å€¼) ---"

    # --- äº¤äº’å¼è·å–ç”¨æˆ·è¾“å…¥ ---
    local NEW_IP NEW_CIDR NEW_GATEWAY NEW_DNS
    read -p "IPåœ°å€ [${CURRENT_IP}]: " NEW_IP
    NEW_IP=${NEW_IP:-$CURRENT_IP}
    if ! is_valid_ip "$NEW_IP"; then echo "âŒ IPåœ°å€æ ¼å¼é”™è¯¯, è·³è¿‡è®¾ç½®ã€‚"; return; fi

    read -p "å­ç½‘æ©ç  (CIDRæ ¼å¼) [${CIDR}]: " NEW_CIDR
    NEW_CIDR=${NEW_CIDR:-$CIDR}
    if ! [[ "$NEW_CIDR" =~ ^[0-9]+$ ]] || [ "$NEW_CIDR" -lt 1 ] || [ "$NEW_CIDR" -gt 32 ]; then
        echo "âŒ CIDRæ ¼å¼é”™è¯¯ (åº”ä¸º1-32ä¹‹é—´çš„æ•°å­—), è·³è¿‡è®¾ç½®ã€‚"; return;
    fi

    read -p "ç½‘å…³ [${GATEWAY}]: " NEW_GATEWAY
    NEW_GATEWAY=${NEW_GATEWAY:-$GATEWAY}
    if ! is_valid_ip "$NEW_GATEWAY"; then echo "âŒ ç½‘å…³åœ°å€æ ¼å¼é”™è¯¯, è·³è¿‡è®¾ç½®ã€‚"; return; fi

    read -p "DNSæœåŠ¡å™¨ (å¤šä¸ªç”¨ç©ºæ ¼éš”å¼€) [${DNS_SERVERS:-223.5.5.5 114.114.114.114}]: " NEW_DNS
    NEW_DNS=${NEW_DNS:-${DNS_SERVERS:-"223.5.5.5 114.114.114.114"}}

    echo "-------------------------------------"
    echo "  - IP:         $NEW_IP/$NEW_CIDR"
    echo "  - Gateway:    $NEW_GATEWAY"
    echo "  - DNS:        $NEW_DNS"
    echo "-------------------------------------"
    read -p "ç¡®è®¤ä»¥ä¸Šä¿¡æ¯å¹¶åº”ç”¨? (y/N): " confirm
    if [[ ! "$confirm" =~ ^[yY]([eE][sS])?$ ]]; then
        echo "  - æ“ä½œå·²å–æ¶ˆã€‚"
        return
    fi

    # --- æ ¹æ®ç³»ç»Ÿç±»å‹ç”Ÿæˆé…ç½® ---
    # ä¼˜å…ˆæ£€æµ‹Netplan (Ubuntu 18.04+)
    if command -v netplan &>/dev/null; then
        echo "  - æ£€æµ‹åˆ° Netplan, å°†ç”Ÿæˆ Netplan é…ç½®..."
        local NETPLAN_FILE
        NETPLAN_FILE=$(find /etc/netplan -name "*.yaml" | head -n 1)
        if [ -z "$NETPLAN_FILE" ]; then
            NETPLAN_FILE="/etc/netplan/01-custom-init.yaml"
            echo "  - æœªæ‰¾åˆ°ç°æœ‰Netplané…ç½®æ–‡ä»¶, å°†åˆ›å»ºäº: $NETPLAN_FILE"
        fi

        cp "$NETPLAN_FILE" "$NETPLAN_FILE.bak_$(date +%Y%m%d%H%M%S)"
        
        # å°†ç©ºæ ¼åˆ†éš”çš„DNSè½¬æ¢ä¸ºYAMLåˆ—è¡¨æ ¼å¼
        local DNS_YAML
        DNS_YAML=$(echo "$NEW_DNS" | sed "s/ /', '/g")

        cat > "$NETPLAN_FILE" <<EOF
network:
  version: 2
  renderer: networkd
  ethernets:
    $IFACE:
      dhcp4: no
      addresses:
        - $NEW_IP/$NEW_CIDR
      routes:
        - to: default
          via: $NEW_GATEWAY
      nameservers:
        addresses: ['$DNS_YAML']
EOF
        echo "  - Netplané…ç½®æ–‡ä»¶å·²ç”Ÿæˆ: $NETPLAN_FILE"
        echo "  - æ­£åœ¨åº”ç”¨é…ç½® (netplan apply)..."
        if netplan apply; then
            echo "âœ… é™æ€IPé…ç½®å·²é€šè¿‡ Netplan åº”ç”¨æˆåŠŸï¼"
        else
            echo "âŒ Netplan åº”ç”¨å¤±è´¥! è¯·æ‰‹åŠ¨æ£€æŸ¥ $NETPLAN_FILE æ–‡ä»¶å¹¶è¿è¡Œ 'netplan apply'ã€‚"
        fi
    # å¤‡ç”¨æ–¹æ¡ˆ: /etc/network/interfaces (Debian/æ—§ç‰ˆUbuntu)
    elif [ -f /etc/network/interfaces ]; then
        echo "  - æœªæ‰¾åˆ° Netplan, å°†ä¿®æ”¹ /etc/network/interfaces..."
        local INTERFACES_FILE="/etc/network/interfaces"
        cp "$INTERFACES_FILE" "$INTERFACES_FILE.bak_$(date +%Y%m%d%H%M%S)"

        # è®¡ç®—ç½‘ç»œåœ°å€å’Œå¹¿æ’­åœ°å€éœ€è¦ bc å‘½ä»¤
        ensure_command "bc" "bc" >/dev/null

        # å°†CIDRè½¬æ¢ä¸ºå­ç½‘æ©ç 
        local i mask
        mask=0
        for ((i=0; i<$NEW_CIDR; i++)); do
            mask=$(( (mask << 1) | 1 ))
        done
        mask=$(( mask << (32 - NEW_CIDR) ))
        local NETMASK
        NETMASK="$(( (mask >> 24) & 255 )).$(( (mask >> 16) & 255 )).$(( (mask >> 8) & 255 )).$(( mask & 255 ))"

        cat > "$INTERFACES_FILE" <<EOF
# This file describes the network interfaces available on your system
# and how to activate them. For more information, see interfaces(5).

source /etc/network/interfaces.d/*

# The loopback network interface
auto lo
iface lo inet loopback

# The primary network interface
auto $IFACE
iface $IFACE inet static
    address $NEW_IP
    netmask $NETMASK
    gateway $NEW_GATEWAY
    dns-nameservers $NEW_DNS
EOF
        echo "âœ… /etc/network/interfaces æ–‡ä»¶å·²æ›´æ–°ã€‚"
        echo "âš ï¸ æ³¨æ„: æ‚¨éœ€è¦é‡å¯ç³»ç»Ÿæˆ–æ‰‹åŠ¨æ‰§è¡Œ 'ifdown $IFACE && ifup $IFACE' æ¥ä½¿æ–°IPç”Ÿæ•ˆã€‚"
        echo "   ä¸ºé˜²æ­¢SSHä¸­æ–­, è„šæœ¬ä¸ä¼šè‡ªåŠ¨é‡å¯ç½‘ç»œã€‚"
    else
        echo "âŒ æ— æ³•æ‰¾åˆ° Netplan æˆ– /etc/network/interfaces, æ— æ³•è‡ªåŠ¨é…ç½®é™æ€IPã€‚"
    fi
    echo "-------------------------------------"
}


# =========================================================
#                   ä¸»æ‰§è¡Œé€»è¾‘
# =========================================================
main() {
    echo "âœ… æƒé™æ£€æŸ¥é€šè¿‡ï¼Œå¼€å§‹æ‰§è¡Œåˆå§‹åŒ–..."
    echo "========================================================="
    
    auto_set_apt_sources
    auto_install_dependencies
    auto_set_timezone
    auto_config_ssh
    auto_disable_firewall
    auto_set_fonts
    
    # äº¤äº’å¼éƒ¨åˆ†æœ€åæ‰§è¡Œ
    read -p "æ˜¯å¦éœ€è¦è¿›è¡Œäº¤äº’å¼é™æ€IPè®¾ç½®? (y/N): " setup_ip
    if [[ "$setup_ip" =~ ^[yY]([eE][sS])?$ ]]; then
        interactive_set_static_ip
    else
        echo "  - å·²è·³è¿‡é™æ€IPè®¾ç½®ã€‚"
        echo "-------------------------------------"
    fi

    echo "ğŸš€ğŸš€ğŸš€ æ‰€æœ‰ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼ğŸš€ğŸš€ğŸš€"
    echo "å»ºè®®é‡å¯ç³»ç»Ÿä»¥ç¡®ä¿æ‰€æœ‰é…ç½®å®Œå…¨ç”Ÿæ•ˆ: reboot"
}

# --- è„šæœ¬æ‰§è¡Œå…¥å£ ---
main
